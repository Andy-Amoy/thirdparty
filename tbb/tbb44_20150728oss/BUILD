cc_library(
    name = 'tbb',
    srcs = [
        "src/tbb/concurrent_hash_map.cpp",
        "src/tbb/concurrent_queue.cpp",
        "src/tbb/concurrent_vector.cpp",
        "src/tbb/dynamic_link.cpp",
        "src/tbb/itt_notify.cpp",
        "src/tbb/cache_aligned_allocator.cpp",
        "src/tbb/pipeline.cpp",
        "src/tbb/queuing_mutex.cpp",
        "src/tbb/queuing_rw_mutex.cpp",
        "src/tbb/reader_writer_lock.cpp",
        "src/tbb/spin_rw_mutex.cpp",
        "src/tbb/x86_rtm_rw_mutex.cpp",
        "src/tbb/spin_mutex.cpp",
        "src/tbb/critical_section.cpp",
        "src/tbb/mutex.cpp",
        "src/tbb/recursive_mutex.cpp",
        "src/tbb/condition_variable.cpp",
        "src/tbb/tbb_thread.cpp",
        "src/tbb/concurrent_monitor.cpp",
        "src/tbb/semaphore.cpp",
        "src/tbb/private_server.cpp",
        "src/rml/client/rml_tbb.cpp",
        "src/tbb/tbb_misc.cpp",
        "src/tbb/tbb_misc_ex.cpp",
        "src/tbb/task.cpp",
        "src/tbb/task_group_context.cpp",
        "src/tbb/governor.cpp",
        "src/tbb/market.cpp",
        "src/tbb/arena.cpp",
        "src/tbb/scheduler.cpp",
        "src/tbb/observer_proxy.cpp",
        "src/tbb/tbb_statistics.cpp",
        "src/tbb/tbb_main.cpp",
        "src/old/concurrent_vector_v2.cpp",
        "src/old/concurrent_queue_v2.cpp",
        "src/old/spin_rw_mutex_v2.cpp",
        "src/old/task_v2.cpp",
    ],
    incs = [
        'include',
        'src',
        'src/rml/include',
    ],
    export_incs = [
        'include'
    ],
    defs = [
        'DO_ITT_NOTIFY',
        'USE_PTHREAD',
        '__TBB_BUILD=1',
        #'TBB_USE_DEBUG=1',
        #'TBB_USE_ASSERT=1',
    ],
    warning = [
        '-Wno-parenthese',
        '-Wno-non-virtual-dtor'
    ],
    extra_cppflags = [
        '-m64',
        '-mrtm',
        '-MMD',
    ]
)
